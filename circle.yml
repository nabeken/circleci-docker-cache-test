machine:
  services:
    - docker

dependencies:
  cache_directories:
    - "~/docker2"
  override:
    - "mkdir -p ~/docker2"
    - "ls -alh ~/docker2"
    - if [[ -e ~/docker2/ubuntu.tar.gz ]]; then docker load -i ~/docker2/ubuntu.tar.gz; else docker pull ubuntu:14.10 && docker save -o ~/docker2/ubuntu.tar ubuntu:14.10; gzip ~/docker2/ubuntu.tar; fi
    - if [[ -e ~/docker2/golang.tar.gz ]]; then docker load -i ~/docker2/golang.tar.gz; else docker pull golang:1.4 && docker save -o ~/docker2/golang.tar golang:1.4; gzip ~/docker2/golang.tar; fi
    - if [[ -e ~/docker2/postgres.tar.gz ]]; then docker load -i ~/docker2/postgres.tar.gz; else docker pull postgres:9.4 && docker save -o ~/docker2/postgres.tar postgres:9.4; gzip ~/docker2/postgres.tar; fi
    - if [[ -e ~/docker2/redis.tar.gz ]]; then docker load -i ~/docker2/redis.tar.gz; else docker pull redis:2.8 && docker save -o ~/docker2/redis.tar redis:2.8; gzip ~/docker2/redis.tar; fi
    - if [[ -e ~/docker2/consul.tar.gz ]]; then docker load -i ~/docker2/consul.tar.gz; else docker pull progrium/consul:consul-0.4 && docker save -o ~/docker2/consul.tar progrium/consul:consul-0.4;gzip ~/docker2/consul.tar;  fi
    - if [[ -e ~/docker2/volume-container.tar.gz ]]; then docker load -i ~/docker2/volume-container.tar.gz; else docker pull nabeken/docker-volume-container-rsync:latest && docker save -o ~/docker2/volume-container.tar nabeken/docker-volume-container-rsync:latest; gzip ~/docker2/volume-container.tar; fi
    - "ls -alh ~/docker2"
    - "rm -f ~/docker2/*.tar"

test:
  override:
    - /bin/true
    - docker version
    - docker info
