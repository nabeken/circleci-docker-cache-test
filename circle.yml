machine:
  services:
    - docker

dependencies:
  cache_directories:
    - "~/docker"
  override:
    - "mkdir -p ~/docker"

test:
  override:
    - if [[ -e ~/docker/ubuntu.tar.gz ]]; then docker load -i ~/docker/ubuntu.tar.gz; else docker pull ubuntu:14.10 && docker save -o ~/docker/ubuntu.tar ubuntu:14.10; gzip ~/docker/ubuntu.tar; fi
    - if [[ -e ~/docker/golang.tar.gz ]]; then docker load -i ~/docker/golang.tar.gz; else docker pull golang:1.4 && docker save -o ~/docker/golang.tar golang:1.4; gzip ~/docker/golang.tar; fi
    - if [[ -e ~/docker/postgres.tar.gz ]]; then docker load -i ~/docker/postgres.tar.gz; else docker pull postgres:9.4 && docker save -o ~/docker/postgres.tar postgres:9.4; gzip ~/docker/postgres.tar; fi
    - if [[ -e ~/docker/redis.tar.gz ]]; then docker load -i ~/docker/redis.tar.gz; else docker pull redis:2.8 && docker save -o ~/docker/redis.tar redis:2.8; gzip ~/docker/redis.tar; fi
    - if [[ -e ~/docker/consul.tar.gz ]]; then docker load -i ~/docker/consul.tar.gz; else docker pull progrium/consul:consul-0.4 && docker save -o ~/docker/consul.tar progrium/consul:consul-0.4; gzip ~/docker/consul.tar; fi
    - if [[ -e ~/docker/volume-container.tar.gz ]]; then docker load -i ~/docker/volume-container.tar.gz; else docker pull nabeken/docker-volume-container-rsync:latest && docker save -o ~/docker/volume-container.tar nabeken/docker-volume-container-rsync:latest; gzip ~/docker/volume-container.tar; fi
